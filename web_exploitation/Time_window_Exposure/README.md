# Time-Window Exposure

A web exploitation challenge where **timing** is the only vulnerability.

---

## Challenge Info

| Field          | Value |
|---------------|-------|
| **Name**       | Time-Window Exposure |
| **Category**   | web |
| **Difficulty** | Easy–Medium |
| **Flag**       | `DSCCTF{m1ll1s3c0nd_m4tt3rs_w3b_2026}`|
| **Port**       | 5000 |

---

## Challenge Description (for CTF platform)

⏱️ Time-Window Exposure [web] – 150 pts

This service always responds.
Permissions are not the problem.
Authentication is not the problem.

The server occasionally exposes sensitive information —
but only for a very brief moment.

Most of the time, you’ll see nothing useful.
Sometimes… timing is everything.

Can you catch it at the right moment?

http://ctf.server.com:5000/flag

Author: Spaghetti99
Difficulty: Easy–Medium

### Using Docker

```bash
docker build -t time-window-exposure .
docker run -p 5000:5000 time-window-exposure

The challenge will be accessible at: http://localhost:5000/flag

Challenge Mechanics

1. Time-Based Exposure Window

The server uses its own system clock
Time is measured in milliseconds
Each minute consists of 60,000 ms
The real flag is returned only when:
(current_time_in_ms % 60000) < 100
This creates a 100 ms exposure window every minute.

2. No Error States

The /flag endpoint always returns HTTP 200
Response format is always identical
No authentication or permissions are involved
This prevents:
error-based guessing
response-size comparison
brute-force exploitation

3. Intended Skillset

Observing server-side behavior
Understanding modulo-based timing logic
Writing simple automation scripts

Intended Solution

Key Insight
The vulnerability is temporal, not logical.
Manual refreshing is unreliable.
Automation guarantees success.

Solution:

Automated Exploit (Python)
import requests
url = "http://TARGET:5000/flag"
while True:
    r = requests.get(url).json()
    if "t1m3_w1nd0w" in r["flag"]:
        print("FLAG FOUND:", r["flag"])
        break

Files:

time-window-exposure/
├── app.py              # Web application logic
├── requirements.txt    # Python dependencies
├── Dockerfile          # Container build
├── README.md           # This file
├── HINT.md             # Player hints
└── WRITEUP.md          # Official solution


Adjusting Difficulty

Make Easier:
Increase window size (e.g. 300–500 ms)
Add a response header with server time

Make Harder:
Reduce window to 30–50 ms
Add slight random jitter
Require two consecutive valid hits