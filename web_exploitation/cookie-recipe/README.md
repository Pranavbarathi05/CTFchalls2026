# Grandma's Secret Recipe

A beginner web challenge teaching about HTTP cookie manipulation and client-side security.

## Challenge Info

| Field | Value |
|-------|-------|
| **Name** | Grandma's Secret Recipe |
| **Category** | Web Exploitation |
| **Difficulty** | Easy |
| **Points** | 100 |
| **Flag** | `DSCCTF{c00k13_t4mp3r1ng_1s_sw33t_2026}` |
| **Port** | 5002 |

---

## Description

üç™ Grandma's Secret Recipe [web] - 100 pts

Grandma has shared her famous chocolate chip cookie recipe online!

But there's one ingredient she's keeping secret...
Only admin users can see it.

Are you clever enough to discover what makes her cookies so special?

üí° Hint: This challenge is about cookies... but not the kind you eat! üç™üíª

---

## Solution

### Method 1: Using Browser DevTools

1. Visit `http://localhost:5002/`
2. Open Browser DevTools (F12)
3. Go to Application/Storage tab ‚Üí Cookies
4. Find cookie named `admin` with value `false`
5. Double-click the value and change it to `true`
6. Refresh the page
7. The secret ingredient (flag) is now visible!

### Method 2: Using curl

```bash
# Visit with admin cookie
curl -b "admin=true" http://localhost:5002/
```

### Method 3: Using Browser Console

```javascript
// Set the cookie
document.cookie = "admin=true";
// Refresh the page
location.reload();
```

---

## Learning Objectives

- **HTTP Cookies**: Understanding how websites store data in the browser
- **Client-Side Trust**: Never trust client-controlled data
- **Cookie Manipulation**: How to modify cookies using DevTools
- **Access Control**: Proper authorization should be server-side, not cookie-based

---

## Deployment

```bash
cd cookie-recipe
docker-compose up -d --build
```

Access at: `http://localhost:5002`

---

## Key Concepts

### What Are HTTP Cookies?

Cookies are small pieces of data stored by the browser and sent with every request to the same domain. They're commonly used for:
- Session management
- User preferences
- Tracking

### The Vulnerability

The application trusts the `admin` cookie value without server-side verification. It simply checks:

```python
is_admin = request.cookies.get('admin') == 'true'
```

This is insecure because:
1. Users can modify their own cookies
2. No cryptographic signature or server validation
3. Access control decision made purely on client data

### Secure Alternative

Proper implementation would:
- Store session data server-side
- Use cryptographically signed cookies
- Validate user permissions on the server
- Never trust client-provided authorization claims

---

## Real-World Impact

Cookie manipulation has led to:
- Privilege escalation vulnerabilities
- Account takeover
- Price manipulation in e-commerce
- Unauthorized access to admin panels

Notable examples:
- Many bug bounty reports involve simple cookie tampering
- Some banking sites had weak cookie-based session management
- E-commerce sites with price stored in cookies

---

## Testing

```bash
# Check without admin cookie
curl http://localhost:5002/

# Check with admin cookie
curl -b "admin=true" http://localhost:5002/ | grep DSCCTF
```

---

## Variations

**Make Easier:**
- Make the hint more obvious: "Try checking your browser cookies!"
- Add a "Debug" button that shows current cookie value

**Make Harder:**
- Use base64 encoding: `admin=ZmFsc2U=` (base64 for "false")
- Add multiple cookies: `role=user` and `permissions=read`
- Use JSON in cookie: `{"admin": false, "role": "guest"}`

---

## Fun Details

The recipe theme serves a dual purpose:
1. Makes the challenge more engaging and memorable
2. Creates confusion with "cookies" (the dessert vs browser cookies)
3. The hint subtly guides players toward the solution

---

## Files

```
cookie-recipe/
‚îú‚îÄ‚îÄ app.py              # Flask application
‚îú‚îÄ‚îÄ Dockerfile          # Container setup  
‚îú‚îÄ‚îÄ docker-compose.yml  # Easy deployment
‚îú‚îÄ‚îÄ description.md      # Challenge description
‚îî‚îÄ‚îÄ README.md          # This file
```

---

## Flag

`DSCCTF{c00k13_t4mp3r1ng_1s_sw33t_2026}`

The flag plays on words: "cookie tampering is sweet" - referring to both the dessert and the vulnerability!
